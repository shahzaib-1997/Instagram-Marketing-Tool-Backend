const allowNumbersInput=document.getElementById("allowNumbers"),allowPeriodsInput=document.getElementById("allowPeriods"),allowUnderscoresInput=document.getElementById("allowUnderscores"),alliterationInput=document.getElementById("alliteration"),prefixSelect=document.getElementById("prefix"),adjectiveCategorySelect=document.getElementById("adjectiveCategory"),nounCategorySelect=document.getElementById("nounCategory"),copyButton=document.getElementById("copy"),usernameInput=document.getElementById("usernameInput"),checkUsernameButton=document.getElementById("checkUsername"),customNoun=document.getElementById("customNoun"),customPrefix=document.getElementById("customPrefix"),alertNode=document.getElementById("alert");usernameInput.addEventListener("input",()=>{usernameInput.value?checkUsernameButton.disabled=!1:checkUsernameButton.disabled=!0});const customNounListener=()=>{customNoun.value?nounCategorySelect.disabled=!0:nounCategorySelect.disabled=!1},customPrefixListener=()=>{customPrefix.value?(prefixSelect.disabled=!0,adjectiveCategorySelect.disabled=!0):(prefixSelect.disabled=!1,adjectiveCategorySelect.disabled=!1)};let prefixFilterValue="";prefixSelect.addEventListener("change",()=>{const e=prefixSelect.options.selectedIndex;prefixFilterValue=prefixSelect.options[e].value,adjectiveCategorySelect.disabled="verbs"===prefixFilterValue||"none"===prefixFilterValue});let adjectiveCategoryValue="";adjectiveCategorySelect.addEventListener("change",()=>{const e=adjectiveCategorySelect.options.selectedIndex;adjectiveCategoryValue=adjectiveCategorySelect.options[e].value});let nounCategoryValue="";function getUsername(){if(!document.cookie.includes("nitreoEmail"))return $("#myModal").modal();checkUsernameButton.disabled=!1,fetch("https://username-generator-api.herokuapp.com/generateUsername",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({allowNumbers:allowNumbersInput.checked,allowPeriods:allowPeriodsInput.checked,allowUnderscores:allowUnderscoresInput.checked,alliteration:alliterationInput.checked,prefixFilter:prefixFilterValue,adjectiveCategory:adjectiveCategoryValue,nounCategory:nounCategoryValue,customNoun:customNoun.value.replace(/[^a-zA-Z0-9._]+/g,""),customPrefix:customPrefix.value.replace(/[^a-zA-Z0-9._]+/g,"")})}).then(async e=>{const t=await e.json();usernameInput.value=t}).catch(e=>console.error("Error..."+e))}nounCategorySelect.addEventListener("change",()=>{const e=nounCategorySelect.options.selectedIndex;nounCategoryValue=nounCategorySelect.options[e].value});const lastUsernameData={username:"",isAvailable:""};let loading=!1;async function checkUsernameAvailability(){const e=usernameInput.value;if(lastUsernameData.username===e)return lastUsernameData.isAvailable?triggerAlert("success",`${e} is available`):triggerAlert("warning",`${e} is taken`);loading||($("#checkUsername").html('<span class="spinner-grow spinner-grow-sm"></span> Check Availability'),loading=!0,await fetch("https://username-generator-api.herokuapp.com/ig",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e})}).then(async t=>{const a=await t.json();if(a.error)return triggerAlert("danger","Something went wrong, please try again.");a.usernameAvailable?(triggerAlert("success",`${e} is available`),lastUsernameData.isAvailable=!0):(triggerAlert("warning",`${e} is taken`),lastUsernameData.isAvailable=!1)}).catch(e=>triggerAlert("danger","Something went wrong, please try again.")),$("#checkUsername").html("Check Availability"),loading=!1,lastUsernameData.username=e)}let showTimer,removeTimer,mauticLoading=!1;async function mautic(e){if($("#emailErrorMsg").html(""),!mauticLoading){$("#modal-continue").prop("disabled",!0);try{mauticLoading=!0;const t=await fetch("https://username-generator-api.herokuapp.com/mautic",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});(await t.json()).invalidEmail?($("#modal-continue").prop("disabled",!1),$("#emailErrorMsg").html('<div class="alert alert-danger small">Please enter a valid Email</div>')):($("#myModal").modal("toggle"),writeCookie("nitreoEmail",e,"336"),getUsername())}catch(e){console.log(e)}finally{mauticLoading=!1}}}function writeCookie(e,t,a){let n=new Date;n.setTime(+n+36e5*a),document.cookie=e+"="+t+"; expires="+n.toGMTString()+"; path=/"}function copyToClipboard(){usernameInput.select(),document.execCommand("copy"),triggerAlert("info",`${usernameInput.value} copied to clipboard`)}function triggerAlert(e,t){window.clearTimeout(showTimer),window.clearTimeout(removeTimer);const a=$("#alert"),n=`<strong>${t}</strong>`;a.html(n),showTimer=setTimeout(()=>{a.removeClass("alert-info alert-danger alert-success alert-warning"),a.addClass(`show alert-${e}`)},0),removeTimer=setTimeout(()=>a.removeClass("show"),3e3)}document.getElementById("modal-form").addEventListener("submit",function(e){e.preventDefault(),mautic(document.querySelector("#modal-email-input").value)});